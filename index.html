<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>StevenTools - Online Tools</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
    :root{
        --bg1: rgba(255,255,255,0.7);
        --card: #ffffff;
        --text: #1f2937;
        --accent: #3b82f6;
        --glass: rgba(255,255,255,0.6);
    }
    [data-theme='dark']{
        --bg1: rgba(6,10,14,0.6);
        --card: rgba(10,14,18,0.75);
        --text: #e6eef6;
        --accent: #60a5fa;
        --glass: rgba(255,255,255,0.03);
    }

    *{box-sizing:border-box}
    body {
        margin: 0;
        font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
        background: linear-gradient(135deg,#eef2f3 0%,#d9e2ec 100%);
        color: var(--text);
        -webkit-font-smoothing:antialiased;
        min-height:100vh;
    }

    header{
        position:sticky;top:0;z-index:40;
        display:flex;align-items:center;justify-content:space-between;
        gap:12px;padding:18px 28px;background:var(--bg1);backdrop-filter:blur(6px);
        border-bottom:1px solid rgba(0,0,0,0.04);
    }

    .brand{display:flex;align-items:center;gap:12px}
    .logo{
        width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;
        background:linear-gradient(135deg,var(--accent),#7c3aed);color:white;font-weight:700;font-size:18px;box-shadow:0 6px 18px rgba(59,130,246,0.18);
    }
    .title{font-weight:700;font-size:18px}

    .controls{display:flex;align-items:center;gap:10px}
    .theme-toggle{padding:8px 12px;border-radius:10px;border:none;cursor:pointer;background:transparent}

    .wrap{max-width:1100px;margin:28px auto;padding:18px;display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:18px}

    .card{
        background:var(--card);border-radius:14px;padding:18px;box-shadow:0 8px 30px rgba(2,6,23,0.06);border:1px solid rgba(15,23,42,0.03);
        backdrop-filter:blur(6px);
    }
    .card h3{margin:0 0 8px 0}
    .muted{color:rgba(0,0,0,0.45);font-size:13px}

    .btn{display:inline-block;padding:10px 14px;border-radius:10px;border:none;background:var(--accent);color:white;cursor:pointer}
    .btn.ghost{background:transparent;color:var(--accent);border:1px solid rgba(59,130,246,0.18)}

    input, textarea, select{width:100%;padding:10px;border-radius:10px;border:1px solid #d1d5db;margin-top:8px;font-size:14px}
    textarea{min-height:90px}

    .output{margin-top:10px;padding:10px;border-radius:10px;background:var(--glass);border:1px solid rgba(0,0,0,0.04);word-break:break-word}

    footer{text-align:center;padding:20px;color:rgba(0,0,0,0.45)}

    /* responsive tweaks */
    @media (max-width:640px){header{padding:12px} .wrap{padding:12px;gap:12px}}
</style>
</head>

<body data-theme="light">
<header>
    <div class="brand">
        <div class="logo">ST</div>
        <div>
            <div class="title">StevenTools</div>
            <div class="muted">è½»é‡å®ç”¨çš„åœ¨çº¿å·¥å…·é›†åˆ</div>
        </div>
    </div>

    <div class="controls">
        <button id="themeBtn" class="theme-toggle" title="åˆ‡æ¢æ·±è‰²/æµ…è‰²">ğŸŒ™/â˜€ï¸</button>
        <button id="downloadBtn" class="btn ghost" title="ä¸‹è½½ç«™ç‚¹æºç ">ä¸‹è½½æºç </button>
    </div>
</header>

<main class="wrap">
    <!-- UUID -->
    <div class="card" id="card-uuid">
        <h3>UUID ç”Ÿæˆå™¨</h3>
        <div class="muted">ç”Ÿæˆ RFC4122 v4 æ ¼å¼çš„ UUID</div>
        <div style="margin-top:12px">
            <button class="btn" onclick="genUUID()">ç”Ÿæˆ UUID</button>
            <button class="btn ghost" onclick="copyToClipboard('uuidOut')">å¤åˆ¶</button>
            <div id="uuidOut" class="output" style="margin-top:10px">ç‚¹å‡»ç”Ÿæˆ</div>
        </div>
    </div>

    <!-- Password -->
    <div class="card" id="card-pw">
        <h3>å¯†ç ç”Ÿæˆå™¨</h3>
        <div class="muted">å¯é€‰é•¿åº¦ä¸åŒ…å«å­—ç¬¦é›†</div>
        <label>é•¿åº¦</label>
        <input type="number" id="pwLen" value="16" min="4" max="128">
        <label style="margin-top:8px">åŒ…å«å­—ç¬¦</label>
        <select id="pwPreset">
            <option value="strong">å¼ºï¼ˆå¤§å°å†™+æ•°å­—+ç¬¦å·ï¼‰</option>
            <option value="alnum">å­—æ¯+æ•°å­—</option>
            <option value="letters">ä»…å­—æ¯</option>
            <option value="custom">è‡ªå®šä¹‰</option>
        </select>
        <input type="text" id="pwCustom" placeholder="è‡ªå®šä¹‰å­—ç¬¦é›†ï¼ˆä»…åœ¨è‡ªå®šä¹‰æ—¶ç”Ÿæ•ˆï¼‰" style="display:none;margin-top:8px">
        <div style="margin-top:10px">
            <button class="btn" onclick="genPassword()">ç”Ÿæˆ</button>
            <button class="btn ghost" onclick="copyToClipboard('pwOut')">å¤åˆ¶</button>
        </div>
        <div id="pwOut" class="output">ç­‰å¾…ç”Ÿæˆ</div>
    </div>

    <!-- AES -->
    <div class="card" id="card-aes">
        <h3>AES åŠ å¯†/è§£å¯†ï¼ˆAES-GCMï¼‰</h3>
        <div class="muted">ä½¿ç”¨ Web Crypto APIï¼Œæœ¬åœ°æ‰§è¡Œï¼Œä¸ä¸Šä¼ æœåŠ¡å™¨</div>
        <label>å¯†é’¥ï¼ˆä»»æ„æ–‡æœ¬ï¼‰</label>
        <input id="aesKey" placeholder="è¾“å…¥å¯†é’¥çŸ­è¯­">
        <label style="margin-top:8px">æ˜æ–‡ / å¯†æ–‡</label>
        <textarea id="aesInput" placeholder="è¾“å…¥æ˜æ–‡æˆ– Base64 å¯†æ–‡"></textarea>
        <div style="margin-top:8px">
            <button class="btn" onclick="aesEncrypt()">åŠ å¯†ï¼ˆè¾“å‡º Base64ï¼‰</button>
            <button class="btn ghost" onclick="aesDecrypt()">è§£å¯†ï¼ˆè¾“å…¥ Base64ï¼‰</button>
            <button class="btn ghost" onclick="clearAes()">æ¸…ç©º</button>
        </div>
        <div id="aesOut" class="output">ç»“æœæ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
    </div>

    <!-- Base64 -->
    <div class="card" id="card-b64">
        <h3>Base64 ç¼–ç /è§£ç </h3>
        <div class="muted">æ”¯æŒ UTF-8 æ–‡æœ¬ä¸ URL å®‰å…¨æ¨¡å¼</div>
        <textarea id="b64Input" placeholder="è¾“å…¥æ–‡æœ¬æˆ– Base64"></textarea>
        <div style="margin-top:8px">
            <button class="btn" onclick="b64Encode()">ç¼–ç </button>
            <button class="btn ghost" onclick="b64Decode()">è§£ç </button>
            <button class="btn ghost" onclick="copyToClipboard('b64Out')">å¤åˆ¶</button>
        </div>
        <div id="b64Out" class="output">ç»“æœæ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
    </div>

    <!-- Text formatter -->
    <div class="card" id="card-text">
        <h3>æ–‡æœ¬æ ¼å¼åŒ– / JSON ç¾åŒ–</h3>
        <div class="muted">æ”¯æŒ JSON ç¾åŒ–ã€å‹ç¼©ä¸è¡Œé¦–ç¼©è¿›</div>
        <textarea id="textInput" placeholder='è¾“å…¥ JSON æˆ–æ–‡æœ¬'></textarea>
        <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap">
            <button class="btn" onclick="prettyJSON()">JSON ç¾åŒ–</button>
            <button class="btn ghost" onclick="minifyJSON()">JSON å‹ç¼©</button>
            <button class="btn ghost" onclick="trimLines()">å»é™¤è¡Œé¦–ç©ºç™½</button>
            <button class="btn ghost" onclick="copyToClipboard('textOut')">å¤åˆ¶</button>
        </div>
        <div id="textOut" class="output">ç»“æœæ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
    </div>

    <!-- Speed test -->
    <div class="card" id="card-speed">
        <h3>ç½‘é¡µæµ‹é€Ÿï¼ˆå¿«é€Ÿï¼‰</h3>
        <div class="muted">æµ‹é‡ DNS/è¿æ¥/TTFB/æ€»åŠ è½½æ—¶é—´ï¼ˆä»…ä½œå‚è€ƒï¼‰</div>
        <input id="speedUrl" placeholder="è¾“å…¥ URLï¼Œä¾‹å¦‚ https://example.com">
        <div style="margin-top:8px">
            <button class="btn" onclick="runSpeedTest()">å¼€å§‹æµ‹è¯•</button>
            <button class="btn ghost" onclick="clearSpeed()">æ¸…ç©º</button>
        </div>
        <div id="speedOut" class="output">æµ‹è¯•ç»“æœä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
    </div>

</main>

<footer>StevenTools â€¢ è½»é‡å·¥å…·é›†åˆ â€” æœ¬ç«™æ‰€æœ‰æ“ä½œå‡åœ¨æµè§ˆå™¨æœ¬åœ°æ‰§è¡Œ</footer>

<script>
// Theme toggle
const themeBtn = document.getElementById('themeBtn');
const body = document.body;
function setTheme(t){
    if(t==='dark') body.setAttribute('data-theme','dark');
    else body.setAttribute('data-theme','light');
    localStorage.setItem('st_theme',t);
}
themeBtn.addEventListener('click', ()=>{
    const cur = localStorage.getItem('st_theme') || 'light';
    setTheme(cur==='light' ? 'dark' : 'light');
});
// init
setTheme(localStorage.getItem('st_theme')||'light');

// Download source (creates a single-file blob)
document.getElementById('downloadBtn').addEventListener('click', ()=>{
    const html = `<!DOCTYPE html>
` + document.documentElement.outerHTML;
    const blob = new Blob([html],{type:'text/html'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href=url; a.download='steventools.html'; a.click();
    URL.revokeObjectURL(url);
});

// Utils
function copyToClipboard(id){
    const el = document.getElementById(id);
    if(!el) return;
    const txt = el.innerText || el.value || '';
    navigator.clipboard.writeText(txt).then(()=>alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿')).catch(()=>alert('å¤åˆ¶å¤±è´¥'));
}

// UUID
function genUUID(){
    try{
        const u = crypto.randomUUID();
        document.getElementById('uuidOut').innerText = u;
    }catch(e){
        // fallback
        const u = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,c=>{
            const r = Math.random()*16|0, v = c==='x'?r:(r&0x3|0x8);
            return v.toString(16);
        });
        document.getElementById('uuidOut').innerText = u;
    }
}

// Password
const presets = {
    strong: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()-_=+[]{}<>?~',
    alnum: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',
    letters: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'
};
const pwPreset = document.getElementById('pwPreset');
pwPreset.addEventListener('change', ()=>{
    document.getElementById('pwCustom').style.display = pwPreset.value==='custom' ? 'block' : 'none';
});
function genPassword(){
    const len = parseInt(document.getElementById('pwLen').value) || 12;
    let chars = presets[pwPreset.value] || '';
    if(pwPreset.value==='custom') chars = document.getElementById('pwCustom').value || 'abcdefghijklmnopqrstuvwxyz';
    if(!chars) return alert('å­—ç¬¦é›†ä¸ºç©º');
    let out = '';
    const array = new Uint32Array(len);
    window.crypto.getRandomValues(array);
    for(let i=0;i<len;i++) out += chars[array[i] % chars.length];
    document.getElementById('pwOut').innerText = out;
}

// AES-GCM helpers
async function deriveKey(password, salt){
    const enc = new TextEncoder();
    const keyMaterial = await window.crypto.subtle.importKey('raw', enc.encode(password), 'PBKDF2', false, ['deriveKey']);
    return crypto.subtle.deriveKey({name:'PBKDF2',salt:enc.encode(salt),iterations:250000,hash:'SHA-256'}, keyMaterial,{name:'AES-GCM', length:256}, false, ['encrypt','decrypt']);
}
function ab2b64(buf){
    const bytes = new Uint8Array(buf);
    let str='';
    for(let i=0;i<bytes.byteLength;i++) str += String.fromCharCode(bytes[i]);
    return btoa(str);
}
function b642ab(b64){
    const str = atob(b64);
    const buf = new Uint8Array(str.length);
    for(let i=0;i<str.length;i++) buf[i]=str.charCodeAt(i);
    return buf.buffer;
}
async function aesEncrypt(){
    const pwd = document.getElementById('aesKey').value || '';
    const plain = document.getElementById('aesInput').value || '';
    if(!pwd || !plain) { alert('è¯·è¾“å…¥å¯†é’¥å’Œæ˜æ–‡'); return; }
    const salt = 'st_salt_v1';
    const key = await deriveKey(pwd, salt);
    const iv = window.crypto.getRandomValues(new Uint8Array(12));
    const enc = new TextEncoder();
    const ct = await crypto.subtle.encrypt({name:'AES-GCM', iv:iv}, key, enc.encode(plain));
    const out = ivToBase64(iv) + ':' + ab2b64(ct);
    document.getElementById('aesOut').innerText = out;
}
async function aesDecrypt(){
    const pwd = document.getElementById('aesKey').value || '';
    const inp = document.getElementById('aesInput').value || '';
    if(!pwd || !inp) { alert('è¯·è¾“å…¥å¯†é’¥å’Œå¯†æ–‡'); return; }
    try{
        const parts = inp.split(':');
        const iv = base64ToUint8(parts[0]);
        const ct = b642ab(parts[1]);
        const key = await deriveKey(pwd, 'st_salt_v1');
        const dec = await crypto.subtle.decrypt({name:'AES-GCM', iv:iv}, key, ct);
        const decStr = new TextDecoder().decode(dec);
        document.getElementById('aesOut').innerText = decStr;
    }catch(e){
        alert('è§£å¯†å¤±è´¥ï¼š' + e.message);
    }
}
function clearAes(){ document.getElementById('aesInput').value=''; document.getElementById('aesOut').innerText=''; }
function ivToBase64(iv){ let s=''; for(let i=0;i<iv.length;i++) s+=String.fromCharCode(iv[i]); return btoa(s); }
function base64ToUint8(b64){ const s=atob(b64); const u=new Uint8Array(s.length); for(let i=0;i<s.length;i++) u[i]=s.charCodeAt(i); return u; }

// Base64
function b64Encode(){
    const txt = document.getElementById('b64Input').value || '';
    try{ const enc = new TextEncoder(); const bytes = enc.encode(txt); let b=''; for(let i=0;i<bytes.length;i++) b+=String.fromCharCode(bytes[i]); document.getElementById('b64Out').innerText = btoa(b); }catch(e){alert('ç¼–ç å¤±è´¥')}
}
function b64Decode(){
    const txt = document.getElementById('b64Input').value || '';
    try{ const str = atob(txt); let u=new Uint8Array(str.length); for(let i=0;i<str.length;i++) u[i]=str.charCodeAt(i); const dec = new TextDecoder().decode(u); document.getElementById('b64Out').innerText = dec; }catch(e){alert('è§£ç å¤±è´¥')}
}

// Text formatter
function prettyJSON(){
    const src = document.getElementById('textInput').value || '';
    try{ const obj = JSON.parse(src); document.getElementById('textOut').innerText = JSON.stringify(obj, null, 2); }catch(e){ alert('ä¸æ˜¯æœ‰æ•ˆ JSON'); }
}
function minifyJSON(){
    const src = document.getElementById('textInput').value || '';
    try{ const obj = JSON.parse(src); document.getElementById('textOut').innerText = JSON.stringify(obj); }catch(e){ alert('ä¸æ˜¯æœ‰æ•ˆ JSON'); }
}
function trimLines(){ const t=document.getElementById('textInput').value; document.getElementById('textOut').innerText = t.split('
').map(s=>s.trimStart()).join('
'); }

// Speed test (simple): measure fetch+download time and TTFB approximation
async function runSpeedTest(){
    const url = document.getElementById('speedUrl').value.trim();
    if(!url) return alert('è¯·è¾“å…¥ URL');
    const out = document.getElementById('speedOut'); out.innerText = 'æ­£åœ¨æµ‹è¯•...';
    try{
        const t0 = performance.now();
        const r = await fetch(url, {mode:'no-cors'}).catch(e=>null);
        const t1 = performance.now();
        // Note: with no-cors responses are opaque; we can't read content-length. Use timing only.
        out.innerText = `è¯·æ±‚å‘å‡ºæ—¶é—´: ${(t1-t0).toFixed(1)} ms (è¿‘ä¼¼ï¼Œæ€»åŠ è½½æ—¶é—´)`;
    }catch(e){ out.innerText = 'æµ‹é€Ÿå¤±è´¥ï¼š' + e.message }
}
function clearSpeed(){ document.getElementById('speedUrl').value=''; document.getElementById('speedOut').innerText=''; }

</script>
</body>
</html>
